"use strict";var e=require("react/jsx-runtime"),n=require("react");const t="split-pane-pane",r=n.forwardRef(function(n,r){const{className:i,style:o,children:s,defaultSize:a,size:u,minSize:c,maxSize:l,...d}=n,h={position:"relative",outline:"none",overflow:"auto",flex:"none",...o},m=[t,i].filter(Boolean).join(" ");return e.jsx("div",{ref:r,className:m,style:h,"data-pane":"true",...d,children:s})});function i(e,n="polite"){const t=document.createElement("div");t.setAttribute("role","status"),t.setAttribute("aria-live",n),t.setAttribute("aria-atomic","true"),t.style.position="absolute",t.style.left="-10000px",t.style.width="1px",t.style.height="1px",t.style.overflow="hidden",t.textContent=e,document.body.appendChild(t),setTimeout(()=>{document.body.removeChild(t)},1e3)}function o(e){return 1e3>e?Math.round(e)+" pixels":Math.round(e/10)/100+" thousand pixels"}const s="split-pane-divider";function a(n){const{direction:t,index:r,isDragging:i,disabled:o,onMouseDown:a,onTouchStart:u,onTouchEnd:c,onKeyDown:l,className:d,style:h,currentSize:m,minSize:p,maxSize:f,children:z}=n,v="horizontal"===t?"vertical":"horizontal",S={...{flex:"none",position:"relative",userSelect:"none",touchAction:"none",..."horizontal"===t?{width:"1px",cursor:o?"default":"col-resize"}:{height:"1px",cursor:o?"default":"row-resize"},...i&&{cursor:"horizontal"===t?"col-resize":"row-resize"}},...h},x=[s,t,i&&"dragging",d].filter(Boolean).join(" "),y=function(e,n){return`${"horizontal"===n?"vertical":"horizontal"} divider ${e+1}`}(r,t),g=function(e){return`Use ${"horizontal"===e?"left and right arrow keys":"up and down arrow keys"} to resize. Hold Shift for larger steps. Press Home or End to minimize or maximize.`}(t);return e.jsx("div",{role:"separator","aria-orientation":v,"aria-label":y,"aria-valuenow":m,"aria-valuemin":p,"aria-valuemax":void 0===f||f===1/0?void 0:f,"aria-description":g,tabIndex:o?-1:0,className:x,style:S,onMouseDown:o?void 0:a,onTouchStart:o?void 0:u,onTouchEnd:o?void 0:c,onKeyDown:o?void 0:l,"data-divider-index":r,children:z})}function u(e,n){if("number"==typeof e)return e;if(e.endsWith("%")){return parseFloat(e)/100*n}if(e.endsWith("px"))return parseFloat(e);const t=parseFloat(e);return isNaN(t)?0:t}function c(e,n,t){return Math.min(Math.max(e,n),t)}function l(e,n,t,r,i){const o=[...e],s=e[n]??0,a=e[n+1]??0,u=r[n+1]??0,l=i[n+1]??1/0;let d=c(s+t,r[n]??0,i[n]??1/0),h=c(a-t,u,l);const m=a-h,p=Math.min(Math.abs(d-s),Math.abs(m));return t>0?(d=s+p,h=a-p):(d=s-p,h=a+p),o[n]=d,o[n+1]=h,o}function d(e){const{direction:t,sizes:r,minSizes:i,maxSizes:o,snapPoints:s=[],snapTolerance:a=10,step:u,onResizeStart:c,onResize:d,onResizeEnd:h}=e,[m,p]=n.useState(!1),[f,z]=n.useState(r),v=n.useRef(null),S=n.useRef(null),x=n.useRef(!0),y=n.useRef(f);y.current=f;const g=n.useRef(h);g.current=h,m||r===f||JSON.stringify(r)===JSON.stringify(f)||z(r),n.useEffect(()=>(x.current=!0,()=>{x.current=!1,S.current&&(cancelAnimationFrame(S.current),S.current=null)}),[]);const w=n.useCallback((e,n)=>{if(!v.current||!x.current)return;const{dividerIndex:r,startPosition:c,startSizes:h}=v.current;let m=("horizontal"===t?e:n)-c;u&&(m=function(e,n){return n>0?Math.round(e/n)*n:e}(m,u));let p=l(h,r,m,i,o);s.length>0&&(p=p.map(e=>function(e,n,t){for(const r of n)if(t>=Math.abs(e-r))return r;return e}(e,s,a))),z(p),d&&d(p,{sizes:p,source:"mouse"})},[t,u,i,o,s,a,d]),E=n.useCallback(e=>{e.preventDefault(),S.current||(S.current=requestAnimationFrame(()=>{S.current=null,x.current&&w(e.clientX,e.clientY)}))},[w]),b=n.useCallback(e=>{e.preventDefault(),S.current||(S.current=requestAnimationFrame(()=>{if(S.current=null,x.current){const n=e.touches[0];n&&w(n.clientX,n.clientY)}}))},[w]),R=n.useCallback(()=>{if(!v.current)return;S.current&&(cancelAnimationFrame(S.current),S.current=null),p(!1);const e=y.current,n=g.current;n&&n(e,{sizes:e,source:"mouse"}),v.current=null},[]),k=n.useCallback(e=>n=>{n.preventDefault();v.current={dividerIndex:e,startPosition:"horizontal"===t?n.clientX:n.clientY,startSizes:f},p(!0),c&&c({sizes:f,source:"mouse",originalEvent:n.nativeEvent})},[t,f,c]),D=n.useCallback(e=>n=>{const r=n.touches[0];if(!r)return;v.current={dividerIndex:e,startPosition:"horizontal"===t?r.clientX:r.clientY,startSizes:f},p(!0),c&&c({sizes:f,source:"touch",originalEvent:n.nativeEvent})},[t,f,c]),A=n.useCallback(e=>{e.preventDefault(),R()},[R]);return n.useEffect(()=>{if(m)return document.addEventListener("mousemove",E),document.addEventListener("mouseup",R),document.addEventListener("touchmove",b,{passive:!1}),document.addEventListener("touchend",R),()=>{document.removeEventListener("mousemove",E),document.removeEventListener("mouseup",R),document.removeEventListener("touchmove",b),document.removeEventListener("touchend",R)}},[m,E,R,b]),{isDragging:m,currentSizes:f,handleMouseDown:k,handleTouchStart:D,handleTouchEnd:A}}const h=10,m=50;function p(e){const{direction:t,sizes:r,minSizes:s,maxSizes:a,step:u=h,largeStep:d=m,onResize:p,onResizeEnd:f}=e,z=n.useRef(null);return{handleKeyDown:n.useCallback(e=>n=>{if(!("horizontal"===t?["ArrowLeft","ArrowRight"]:["ArrowUp","ArrowDown"]).includes(n.key)&&"Home"!==n.key&&"End"!==n.key&&"Escape"!==n.key)return;if(n.preventDefault(),"Escape"===n.key){if(z.current){const e=z.current;z.current=null,p&&p(e,{sizes:e,source:"keyboard",originalEvent:n.nativeEvent}),f&&f(e,{sizes:e,source:"keyboard",originalEvent:n.nativeEvent}),i("Pane sizes restored")}return}null===z.current&&(z.current=[...r]);let h=0,m=[...r],v="arrow";switch(n.key){case"ArrowLeft":case"ArrowUp":h=-(n.shiftKey?d:u);break;case"ArrowRight":case"ArrowDown":h=n.shiftKey?d:u;break;case"Home":{v="home";const n=e+1,t=s[e]??0,i=(r[e]??0)+(r[n]??0);m[e]=t,m[n]=i-t;break}case"End":{v="end";const n=e,t=e+1,i=(r[n]??0)+(r[t]??0);m[n]=Math.min(a[n]??1/0,i-(s[t]??0)),m[t]=i-m[n];break}}if(0!==h&&(m=l(r,e,h,s,a)),m=m.map((e,n)=>c(e,s[n]??0,a[n]??1/0)),p&&p(m,{sizes:m,source:"keyboard",originalEvent:n.nativeEvent}),f&&f(m,{sizes:m,source:"keyboard",originalEvent:n.nativeEvent}),"home"===v)i(`Pane ${e+1} minimized to ${o(m[e]??0)}`);else if("end"===v)i(`Pane ${e+1} maximized to ${o(m[e]??0)}`);else{const n=h>0?e:e+1;i(`Pane ${n+1} resized to ${o(m[n]??0)}`)}},[t,r,s,a,u,d,p,f])}}const f="split-pane";exports.Divider=a,exports.Pane=r,exports.SplitPane=function(t){const{direction:i="horizontal",resizable:o=!0,snapPoints:s,snapTolerance:c=10,step:l,onResizeStart:h,onResize:m,onResizeEnd:z,className:v,style:S,divider:x,dividerStyle:y,dividerClassName:g,children:w}=t,E=n.useRef(null),[b,R]=n.useState(0),k=n.useRef(0),D=n.useMemo(()=>n.Children.toArray(w).filter(e=>"object"==typeof e&&null!==e&&"props"in e).map(e=>({props:e.props,size:e.props.size,defaultSize:e.props.defaultSize,minSize:e.props.minSize??0,maxSize:e.props.maxSize??1/0})),[w]),A=D.length,M=n.useRef(!1);2>A&&!M.current&&(M.current=!0,console.warn(`SplitPane requires at least 2 Pane children. Received ${A}.`));const{minSizes:C,maxSizes:P}=n.useMemo(()=>{if(0===b)return{minSizes:Array(A).fill(0),maxSizes:Array(A).fill(1/0)};const e=[],n=[];return D.forEach(t=>{e.push(u(t.minSize,b)),n.push(t.maxSize===1/0?1/0:u(t.maxSize,b))}),{minSizes:e,maxSizes:n}},[b,A,D]),T=n.useCallback(e=>{if(0===e)return Array(A).fill(0);const n=D.map(n=>{const t=n.size??n.defaultSize;return void 0!==t?u(t,e):null}),t=n.reduce((e,n)=>e+(n??0),0),r=n.filter(e=>null===e).length,i=r>0?(e-t)/r:0;return n.map(e=>null===e?i:e)},[A,D]),[N,j]=n.useState(()=>T(b)),L=n.useCallback(e=>{const n=k.current;k.current=e,0!==e&&j(t=>t.every(e=>0===e)||t.length!==A?T(e):n>0&&n!==e?function(e,n){const t=e.reduce((e,n)=>e+n,0);if(0===t){const t=n/e.length;return e.map(()=>t)}return e.map(e=>e/t*n)}(t,e):0===n?T(e):t)},[A,T]);n.useEffect(()=>{const e=E.current;if(!e)return;const n=new ResizeObserver(e=>{const n=e[0];n&&(e=>{const n="horizontal"===i?e.width:e.height;n>0&&(R(n),L(n))})(n.contentRect)});return n.observe(e),()=>{n.disconnect()}},[i,L]);const $=n.useCallback((e,n)=>{j(e),m?.(e,n)},[m]),{isDragging:F,currentSizes:K,handleMouseDown:I,handleTouchStart:q,handleTouchEnd:O}=d({direction:i,sizes:N,minSizes:C,maxSizes:P,snapPoints:s,snapTolerance:c,step:l,onResizeStart:h,onResize:$,onResizeEnd:z}),{handleKeyDown:H}=p({direction:i,sizes:K,minSizes:C,maxSizes:P,step:l,onResize:$,onResizeEnd:z}),J={display:"flex",flexDirection:"horizontal"===i?"row":"column",height:"100%",width:"100%",overflow:"hidden",position:"relative",...S},X=[f,i,v].filter(Boolean).join(" ");return e.jsx("div",{ref:E,className:X,style:J,children:b>0&&(()=>{if(2>A)return null;const n=[];return D.forEach((t,s)=>{const u=K[s]??0,c={..."horizontal"===i?{width:u+"px",height:"100%"}:{height:u+"px",width:"100%"},...t.props.style};if(n.push(e.jsx(r,{...t.props,style:c,children:t.props.children},"pane-"+s)),A-1>s){const t=C[s],r=P[s];n.push(e.jsx(x??a,{direction:i,index:s,isDragging:F,disabled:!o,onMouseDown:I(s),onTouchStart:q(s),onTouchEnd:O,onKeyDown:H(s),className:g,style:y,currentSize:u,minSize:t,maxSize:r===1/0?void 0:r},"divider-"+s))}}),n})()})},exports.useKeyboardResize=p,exports.usePersistence=function(e){const{key:t,storage:r=localStorage,debounce:i=300}=e,[o,s]=n.useState(()=>{try{const e=r.getItem(t);return e?JSON.parse(e):[]}catch{return[]}});return n.useEffect(()=>{if(0===o.length)return;const e=setTimeout(()=>{try{r.setItem(t,JSON.stringify(o))}catch(e){console.warn("Failed to persist pane sizes:",e)}},i);return()=>clearTimeout(e)},[o,t,r,i]),[o,s]},exports.useResizer=d;
//# sourceMappingURL=index.cjs.map
